## 5. Shape query result

You might run across the situation where your query is too verbose.

```
const Submarine=require('Submarine');

const ShapeQueryResult=class extends Submarine {
  query(){
    return {
      ip_addrs_171: String.raw`
        ip -o -f inet a \
          |awk '{print $4}' \
        |grep "^171"
      `,

      ip_addrs_172: String.raw`
        ip -o -f inet a \
          |awk '{print $4}' \
        |grep "^172"
      `,

    };
  }
 
}


const shape=new ShapeQueryResult({
  conn: 'ssh',
  host: 'server1',
});
    


shape.current()
  .then(console.log)
  .catch(console.error);
```

Same `ip ~` commands are written twice (so it is run twice) and each execution makes `ssh` connection wastfully (usually slower than local exec). This can be replaced bellow.

```
const Submarine=require('Submarine');

const ShapeQueryResult=class extends Submarine {
  query(){
    return {
      ip_addrs: String.raw`
        ip -o -f inet a \
          |awk '{print $4}'
      `,
    };
  }

  format(stats){
    const ip_addrs = Array.isArray(stats.ip_addrs)
      ? stats.ip_addrs
      : [ stats.ip_addrs ];

    return {
      ip_addrs_171: stats.ip_addrs.filter(
        addr => addr.match(/^171/)
      ),

      ip_addrs_172: stats.ip_addrs.filter(
        addr => addr.match(/^172/)
      ),
    };
  }
 
}


const shape=new ShapeQueryResult({
  conn: 'ssh',
  host: 'server1',
});
    


shape.current()
  .then(console.log)
  .catch(console.error);
```

`format` interface is helpful to shape the result of query with Node.js features.

