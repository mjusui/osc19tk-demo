const Submarine=require('Submarine');

const ExportHttpEndpoint=class extends Submarine {
  query(){
    return {
      hostname: 'hostname -s',

      ip_addrs: String.raw`
        ip -o -f inet a \
          |awk '{print $4}'
      `,

      tail: String.raw`
        sudo tail -n 6 \
          /var/log/syslog
      `,
    };
  }
}


const endpoint=new ExportHttpEndpoint({
  conn: 'ssh',
  host: 'server1',
});


endpoint.communicate({
  port: 30117,
  pathname: '/logs/syslog',
  cache: 5 * 1024,
  get: sub => sub.current(),
});
